export THIS_DIR="$(cd "$(dirname "$(readlink -f "${BASH_SOURCE[0]}")")" && pwd)"
set -o allexport
source $THIS_DIR/.env
set +o allexport


if [ $# -lt 2 ]; then
  echo "Usage: $(basename $0) <address> <topic> [<fromBlock>] [<toBlock>]"
  exit 1
fi

ADDRESS=$1
TOPIC=$2
FROM="${2:-1}"
TO="${3:-latest}"

curl "https://api.etherscan.io/api?module=logs&action=getLogs&address=$ADDRESS&fromBlock=$FROM&toBlock=$TO&apikey=$ETHERSCAN_API_KEY&topic0=$TOPIC" | jq
